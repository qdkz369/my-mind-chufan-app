# åˆ›å»ºç®¡ç†å‘˜è´¦å·æŒ‡å—

## ğŸ¯ é—®é¢˜è¯´æ˜

å¾ªç¯ç™»å½•é—®é¢˜å·²è§£å†³ âœ…ï¼Œä½†ç°åœ¨é‡åˆ°è´¦å·å¯†ç é—®é¢˜ï¼šæç¤º "Invalid login credentials"ï¼ˆæ— æ•ˆçš„ç™»å½•å‡­æ®ï¼‰ã€‚

è¿™æ„å‘³ç€éœ€è¦åœ¨ Supabase ä¸­åˆ›å»ºç®¡ç†å‘˜è´¦å·ã€‚

---

## ğŸ“‹ æ–¹æ³•ä¸€ï¼šé€šè¿‡ Supabase Dashboard åˆ›å»ºï¼ˆæ¨èï¼‰

### æ­¥éª¤ 1ï¼šåˆ›å»ºç”¨æˆ·è´¦å·

1. **æ‰“å¼€ Supabase Dashboard**
   - è®¿é—®ä½ çš„ Supabase é¡¹ç›®ï¼šhttps://supabase.com/dashboard
   - é€‰æ‹©ä½ çš„é¡¹ç›®

2. **è¿›å…¥ Authentication é¡µé¢**
   - ç‚¹å‡»å·¦ä¾§èœå•çš„ **"Authentication"**
   - ç‚¹å‡» **"Users"** æ ‡ç­¾é¡µ

3. **åˆ›å»ºæ–°ç”¨æˆ·**
   - ç‚¹å‡»å³ä¸Šè§’çš„ **"Add user"** æŒ‰é’®
   - é€‰æ‹© **"Create new user"**

4. **å¡«å†™ç”¨æˆ·ä¿¡æ¯**
   - **Email**: è¾“å…¥ä½ çš„é‚®ç®±ï¼ˆä¾‹å¦‚ï¼š`admin@test.com`ï¼‰
   - **Password**: è¾“å…¥å¯†ç ï¼ˆè‡³å°‘ 6 ä½å­—ç¬¦ï¼‰
   - **Auto Confirm User**: âœ… **å‹¾é€‰**ï¼ˆé‡è¦ï¼è¿™æ ·ç”¨æˆ·æ‰èƒ½ç«‹å³ç™»å½•ï¼‰
   - ç‚¹å‡» **"Create user"**

5. **å¤åˆ¶ç”¨æˆ· UUID**
   - åˆ›å»ºæˆåŠŸåï¼Œåœ¨ç”¨æˆ·åˆ—è¡¨ä¸­æ‰¾åˆ°åˆšåˆ›å»ºçš„ç”¨æˆ·
   - ç‚¹å‡»ç”¨æˆ·ï¼ŒæŸ¥çœ‹è¯¦æƒ…
   - **å¤åˆ¶ç”¨æˆ·çš„ UUID**ï¼ˆæ ¼å¼ç±»ä¼¼ï¼š`9e2724e9-9b4b-4ddd-a647-9b32a6520b32`ï¼‰

### æ­¥éª¤ 2ï¼šåˆ†é…ç®¡ç†å‘˜è§’è‰²

1. **æ‰“å¼€ SQL Editor**
   - åœ¨ Supabase Dashboard ä¸­ï¼Œç‚¹å‡»å·¦ä¾§èœå•çš„ **"SQL Editor"**

2. **æ‰§è¡Œä»¥ä¸‹ SQL è„šæœ¬**
   ```sql
   -- å°† 'ä½ çš„ç”¨æˆ·UUID' æ›¿æ¢ä¸ºæ­¥éª¤1ä¸­å¤åˆ¶çš„ UUID
   INSERT INTO user_roles (user_id, role)
   VALUES ('ä½ çš„ç”¨æˆ·UUID', 'super_admin')
   ON CONFLICT (user_id) DO UPDATE SET role = 'super_admin';
   ```

3. **éªŒè¯è§’è‰²åˆ†é…**
   ```sql
   -- æŸ¥çœ‹æ‰€æœ‰ç®¡ç†å‘˜
   SELECT 
     u.email,
     ur.role,
     u.created_at
   FROM auth.users u
   JOIN user_roles ur ON u.id = ur.user_id
   WHERE ur.role IN ('super_admin', 'admin')
   ORDER BY u.created_at;
   ```

---

## ğŸ“‹ æ–¹æ³•äºŒï¼šä½¿ç”¨ Supabase CLIï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ å®‰è£…äº† Supabase CLIï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºï¼š

```bash
# å®‰è£… Supabase CLIï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install -g supabase

# ç™»å½•
supabase login

# åˆ›å»ºç”¨æˆ·ï¼ˆéœ€è¦æ›¿æ¢é¡¹ç›®å¼•ç”¨å’Œé‚®ç®±å¯†ç ï¼‰
supabase auth admin create-user \
  --email admin@test.com \
  --password your_password \
  --email-confirm
```

---

## ğŸ§ª æµ‹è¯•ç™»å½•

### 1. ç¡®è®¤è´¦å·å·²åˆ›å»º
- åœ¨ Supabase Dashboard â†’ Authentication â†’ Users ä¸­ï¼Œç¡®è®¤ç”¨æˆ·å­˜åœ¨
- ç¡®è®¤ç”¨æˆ·çŠ¶æ€ä¸º **"Confirmed"**ï¼ˆå·²ç¡®è®¤ï¼‰

### 2. ç¡®è®¤è§’è‰²å·²åˆ†é…
- åœ¨ SQL Editor ä¸­æ‰§è¡ŒéªŒè¯æŸ¥è¯¢ï¼Œç¡®è®¤ç”¨æˆ·æœ‰ `super_admin` è§’è‰²

### 3. æµ‹è¯•ç™»å½•
- è®¿é—® `http://localhost:3000/login`
- è¾“å…¥åˆšæ‰åˆ›å»ºçš„é‚®ç®±å’Œå¯†ç 
- ç‚¹å‡»ç™»å½•

**é¢„æœŸç»“æœï¼š**
- âœ… ç™»å½•æˆåŠŸ
- âœ… è‡ªåŠ¨è·³è½¬åˆ° `/dashboard`
- âœ… ä¸å†å‡ºç° "Invalid login credentials" é”™è¯¯

---

## ğŸ” å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šæç¤º "Invalid login credentials"
**å¯èƒ½åŸå› ï¼š**
- é‚®ç®±æˆ–å¯†ç è¾“å…¥é”™è¯¯
- ç”¨æˆ·æœªåˆ›å»º
- ç”¨æˆ·æœªç¡®è®¤ï¼ˆAuto Confirm User æœªå‹¾é€‰ï¼‰

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥é‚®ç®±å’Œå¯†ç æ˜¯å¦æ­£ç¡®
2. åœ¨ Supabase Dashboard ä¸­ç¡®è®¤ç”¨æˆ·å­˜åœ¨
3. ç¡®è®¤ç”¨æˆ·çŠ¶æ€ä¸º "Confirmed"
4. å¦‚æœæœªç¡®è®¤ï¼Œå¯ä»¥æ‰‹åŠ¨ç¡®è®¤æˆ–é‡ç½®å¯†ç 

### é—®é¢˜2ï¼šç™»å½•æˆåŠŸä½†æç¤º"æ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™"
**å¯èƒ½åŸå› ï¼š**
- ç”¨æˆ·è§’è‰²æœªåˆ†é…
- è§’è‰²åˆ†é…é”™è¯¯

**è§£å†³æ–¹æ³•ï¼š**
1. æ‰§è¡ŒéªŒè¯æŸ¥è¯¢ï¼Œç¡®è®¤ç”¨æˆ·æœ‰ `super_admin` æˆ– `admin` è§’è‰²
2. å¦‚æœæ²¡æœ‰ï¼Œæ‰§è¡Œè§’è‰²åˆ†é… SQL

### é—®é¢˜3ï¼šç”¨æˆ·å·²åˆ›å»ºä½†æ— æ³•ç™»å½•
**å¯èƒ½åŸå› ï¼š**
- ç”¨æˆ·æœªç¡®è®¤
- å¯†ç é”™è¯¯

**è§£å†³æ–¹æ³•ï¼š**
1. åœ¨ Supabase Dashboard â†’ Authentication â†’ Users ä¸­
2. æ‰¾åˆ°ç”¨æˆ·ï¼Œç‚¹å‡» **"Actions"** â†’ **"Send password reset email"**
3. æˆ–è€…ç›´æ¥é‡ç½®å¯†ç 

---

## ğŸ“ å¿«é€Ÿåˆ›å»ºè„šæœ¬

å¦‚æœä½ å·²ç»çŸ¥é“ç”¨æˆ· UUIDï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œï¼š

```sql
-- 1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
SELECT id, email, confirmed_at 
FROM auth.users 
WHERE email = 'admin@test.com';

-- 2. åˆ†é…è§’è‰²ï¼ˆæ›¿æ¢ UUIDï¼‰
INSERT INTO user_roles (user_id, role)
VALUES ('ä½ çš„ç”¨æˆ·UUID', 'super_admin')
ON CONFLICT (user_id) DO UPDATE SET role = 'super_admin';

-- 3. éªŒè¯
SELECT 
  u.email,
  ur.role,
  u.confirmed_at
FROM auth.users u
LEFT JOIN user_roles ur ON u.id = ur.user_id
WHERE u.email = 'admin@test.com';
```

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] åœ¨ Supabase Dashboard ä¸­åˆ›å»ºäº†ç”¨æˆ·
- [ ] ç”¨æˆ·çŠ¶æ€ä¸º "Confirmed"
- [ ] æ‰§è¡Œäº†è§’è‰²åˆ†é… SQL
- [ ] éªŒè¯æŸ¥è¯¢æ˜¾ç¤ºç”¨æˆ·æœ‰ `super_admin` è§’è‰²
- [ ] ä½¿ç”¨æ­£ç¡®çš„é‚®ç®±å’Œå¯†ç æµ‹è¯•ç™»å½•
- [ ] ç™»å½•æˆåŠŸå¹¶è·³è½¬åˆ° dashboard

---

**æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ“ä½œåï¼Œåº”è¯¥å°±èƒ½æˆåŠŸç™»å½•äº†ï¼** ğŸš€
