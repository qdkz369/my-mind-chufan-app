# 控制台错误修复指南

## 已修复的错误

### 1. ✅ icon-192.png 和 icon-512.png 404 错误

**问题：** `manifest.json` 中引用了 `.png` 文件，但实际文件是 `.jpg` 格式

**修复：** 已更新 `public/manifest.json`，将图标路径改为：
- `/icon-192.jpg` (原来是 `/icon-192.png`)
- `/icon-512.jpg` (原来是 `/icon-512.png`)
- 添加了 `/apple-icon.png` 作为备用

**验证：** 刷新页面后，404 错误应该消失

### 2. ✅ 注册更新404错误自动恢复

**问题：** localStorage 中有 restaurantId，但数据库中不存在，导致更新返回404

**修复：** 已添加自动恢复逻辑：
- 如果更新返回404，自动清除 localStorage
- 自动切换到注册模式（POST）
- 使用相同表单数据重新注册

## 剩余警告（不影响功能）

### 1. ⚠️ Supabase未配置警告

**说明：** 如果看到 `[加载餐厅信息] Supabase未配置，使用localStorage数据`，这是正常的：
- 系统会使用 localStorage 中的缓存数据
- 不影响基本功能
- 如果已配置 `.env.local`，这个警告会消失

### 2. ⚠️ 图标下载错误

**说明：** 如果看到图标下载错误，可以忽略：
- 这些是 PWA 相关的资源
- 不影响核心功能
- 如果需要，可以创建对应的图标文件

## 如何验证修复

1. **刷新浏览器页面**（F5 或 Ctrl+R）
2. **打开控制台**（F12）
3. **检查错误数量**：
   - 红色错误应该减少
   - 黄色警告可以忽略（不影响功能）

## 如果仍有404错误

### API路由404

如果看到 `api/restaurant/register` 404错误：

1. **检查开发服务器是否运行**
   ```bash
   npm run dev
   ```

2. **检查API路由文件是否存在**
   - 确认 `app/api/restaurant/register/route.ts` 文件存在

3. **重启开发服务器**
   - 停止服务器（Ctrl+C）
   - 重新启动：`npm run dev`

### 图标404

如果仍有图标404错误：

1. **检查文件是否存在**
   - `public/icon-192.jpg`
   - `public/icon-512.jpg`

2. **如果文件不存在，可以创建或使用现有图标**
   - 将 `apple-icon.png` 复制为 `icon-192.png` 和 `icon-512.png`
   - 或更新 `manifest.json` 使用现有图标

## 清除控制台错误的最佳实践

1. **硬刷新页面**：Ctrl+Shift+R（清除缓存）
2. **清除浏览器缓存**：设置 → 清除浏览数据
3. **重启开发服务器**：确保所有更改生效

